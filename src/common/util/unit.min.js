import{point,polygon,booleanPointInPolygon,rhumbDistance}from "@turf/turf";import{map2Url,map3Url}from "@/api/baseUrl";const px=12;class Unit{setItem=(a,b)=>sessionStorage.setItem(a,JSON.stringify(b));getItem=o=>JSON.parse(sessionStorage.getItem(o));setImg=o=>process.env.BASE_URL+o;Sum=array=>{if(array.length<=0){return 0}var sum=array.map(Number).reduce((prev,cur)=>prev+cur);return sum};unique=o=>Array.from(new Set(o)).filter(x=>x);isArray=o=>Object.prototype.toString.call(o)=="[object Array]";isObject=o=>Object.prototype.toString.call(o)=="[object Object]";timers=o=>(!o?new Date().getFullYear():o.getFullYear());s=(a,b)=>a.map((m,n)=>parseFloat(m)-parseFloat(b[n]));c=(a,b)=>a.map((m,n)=>(m?b[n]/m:0).toFixed(2));currYear=o=>(o?o:new Date().getFullYear());randomArray=(a,b=4)=>{var values=[];var newArr=(arr)=>arr.sort(()=>(Math.random()-0.5));for(var i=0;i<b;i+=1){if(i==b-1){values[i]=a;return newArr(values)}var value=Math.floor(Math.random()*(a/(b-i)));values[i]=value;a=a-value}};random=(m,n,L)=>{let arr=[];var random=function(lower,upper){return Math.floor(Math.random()*(upper-lower+1))+lower};if(L){for(var i=0;i<L;i+=1){arr.push(random(m,n))}return arr}else{return random(m,n)}};randomColor=n=>{var len=Object.keys(Array(n).toString().split(","));if(!n){return("#"+("00000"+((Math.random()*0x1000000)<<0).toString(16)).substr(-6))}else{return len.map(()=>"#"+("00000"+((Math.random()*0x1000000)<<0).toString(16)).substr(-6))}};getUrlParam=(key,defaultValue='')=>{var pageUrl=window.location.search.substring(1);var pairs=pageUrl.split('&');for(var i=0;i<pairs.length;i+=1){var keyAndValue=pairs[i].split('=');if(keyAndValue[0]===key){return keyAndValue[1]}}return defaultValue};parseParams=(data)=>{try{var tempArr=[];for(var i in data){var key=encodeURIComponent(i);var value=encodeURIComponent(data[i]);tempArr.push(key+'='+value)}var urlParamsStr=tempArr.join('&');return urlParamsStr}catch(err){return ''}};getParams=(url)=>{try{var index=url.indexOf('?');url=url.match(/\?([^#]+)/)[1];var obj={},arr=url.split('&');for(var i=0;i<arr.length;i+=1){var subArr=arr[i].split('=');var key=decodeURIComponent(subArr[0]);var value=decodeURIComponent(subArr[1]);obj[key]=value}return obj}catch(err){return null}};paint=(a,b,c)=>a.map(v=>{return{"type":"Feature","properties":{"icon":c,"name":b,"description":v.name,"pointX":v.long,"pointY":v.lat},"geometry":{"type":"Point","coordinates":[v.long,v.lat]}}});coord=(a,b)=>{let X=[];for(let i=0;i<b;i+=1){var Y=a.split(",").map(v=>parseFloat(v)+this.random(-9999999999,9999999999)/Math.pow(10,12));X.push(Y)}return X};coordArr=(a,b)=>{let X=[];for(let i=0;i<b;i+=1){var Y=a.split(",").map(v=>parseFloat(v)+this.random(-9999999999,9999999999)/Math.pow(10,12));X.push({x:Y[0],y:Y[1],value:this.random(10,100)})}return X};center=()=>{return{zoom:10,minzoom:10,maxzoom:17,rotation:0,center:[116.1766017973423,39.735209941864014],extent:[115.97332215218042,39.56875874817189,116.60503601936792,40.14279439270314],D2URL:map2Url+'iserver/services/map-LiangXiang/rest/maps/LXMAP_DITU',D3URL:map3Url+'iserver/services/3D-build_school_big15/rest/realspace'}};createPoint=(location,properties)=>{let res=point(location,properties);return res};inArea=(lngLat,bbox)=>{let res=booleanPointInPolygon(point(lngLat),polygon(bbox));return res};isDistance=(a,b)=>{var from=point(a);var to=point(b);var options={units:'meters'};var distance=rhumbDistance(from,to,options);return distance};getMax=(n,m)=>{var min=n;m<n&&(min=m);var max=0;for(var i=0,arr=[];i<=min;i+=1){if(n%i==0&&m%i==0){arr.push(i)}}for(var j=0;j<arr.length;j+=1){if(arr[j]>arr[j+1]){arr[j]=[arr[j+1],(arr[j+1]=arr[j])][0]}}max=arr[arr.length-1];return[n/max,m/max]};getFormatDate=(m,n)=>{var u=":";var v="-";var w="";var YY=m.getFullYear();var MM=m.getMonth()+1;var DD=m.getDate();var hh=m.getHours();var mm=m.getMinutes();var ss=m.getSeconds();if(MM>=1&&MM<=9){MM="0"+MM}if(DD>=0&&DD<=9){DD="0"+DD}if(hh>=0&&hh<=9){hh=" 0"+hh}else{hh=" "+hh}if(mm>=0&&mm<=9){mm="0"+mm}if(ss>=0&&ss<=9){ss="0"+ss}if(n=="d"){w=hh+u+mm+u+ss}if(n=="d0"){w=" 00:00:00"}if(n=="d1"){w=" 23:59:59"}if(n=="m0"){DD=new Date(YY,MM,1).getDate()}if(n=="m1"){DD=new Date(YY,MM,0).getDate()}var currentdate=YY+v+MM+v+DD+w;return currentdate};myBrowser=()=>{var userAgent=navigator.userAgent;var isOpera=userAgent.indexOf("Opera")>-1;var isIE=userAgent.indexOf("Trident")>-1&&!isOpera;var isEdge=userAgent.indexOf("Edge")>-1;var isFF=userAgent.indexOf("Firefox")>-1;var isSafari=userAgent.indexOf("Safari")>-1&&userAgent.indexOf("Chrome")==-1;var isChrome=userAgent.indexOf("Chrome")>-1&&userAgent.indexOf("Safari")>-1;if(isIE){return "IE"}if(isOpera){return "Opera"}if(isEdge){return "Edge"}if(isFF){return "FF"}if(isSafari){return "Safari"}if(isChrome){return "Chrome"}}tooltip=(o,l)=>{var body={trigger:o?"item":"axis",confine:true,axisPointer:{type:!isNaN(l)?"shadow":"line",lineStyle:{color:"#07b5ff"}},textStyle:{width:px*3,height:px*3,fontSize:px,align:"left"},backgroundColor:"rgba(0,0,0,0.7)",padding:[px*0.5,px*0.5],extraCssText:"box-shadow: 0 0 30px 1px rgba(7, 181, 255, 0.7);"};if(o=="axis"){body.formatter=!isNaN(l)&&l==0?`{b${ l }}: {c${ l }}`:`{b}: {c}`}if(o=="item"){body.formatter="{b}: {c} ({d}%)"}if(o=="time"){body.formatter="{a}<br/>{b} : {c}%"}return body};xAxis=(o,b,c,d)=>{var body={type:"category",boundaryGap:d?false:true,axisLine:{show:b?false:true,lineStyle:{color:"#109ca9"}},axisLabel:{textStyle:{color:"#fff",lineHeight:px*2,fontSize:c||px}},axisTick:{show:false},splitLine:{show:false}};if(o){body.data=o}return body};grid=(a,b,c,d)=>{return{top:a||28,right:b||0,bottom:c||-1,left:d||0,containLabel:true}};legend=(o,algin)=>{var body={type:"scroll",orient:"horizontal",x:algin?algin:"center",top:px*0.2,width:'80%',itemWidth:px*1.4,itemHeight:px*0.95,textStyle:{color:"#fff",fontSize:px,padding:[px*0.3,px*0.3,0,px*0.3]},data:o};if(o){body.data=o}return body}}export default Unit;